<div class="container comments_section">

  <h2>Comments<small> ({{object.comment_set.all|length}})</small></h2>

  {% if user.is_authenticated %}
    <form method="post" action="{% url 'comment:create' slug=object.slug %}">{% csrf_token %}
        <span id="comment_form">{{ form.as_p }}</span>
        <button type="submit" class="btn btn-default">Save</button>
    </form>

  {% else %}
    <b><a href="{% url 'accounts:login' %}">Login</a> to post comments</b>
  {% endif %}

  <!--- Comments --->
  {% for comment in comment_list %}
    {% if comment.is_reply %}
      <div class="container-fluid commentContainer reply">
        <span class="comment_identifier">#{{ comment.identifier }} </span><b id="comment_author">{{ comment.author }}</b>
        <span id="comment_info"> {{ comment.created|timesince }} ago</span>
        <br /><span class="reply_parent">@{{ comment.parent.identifier }}</span>
        <p>{{ comment.content }}</p>
        {% if comment.author == request.user %}
          <b><a href="{% url 'comment:update' pk=comment.pk %}" class="edit_and_delete">Edit</a></b>
          <b><a href="{% url 'comment:delete' pk=comment.pk %}" class="edit_and_delete">Delete</a></b>
        {% endif %}

        {% if user.is_authenticated and comment.author != request.user %}
          <b><a href="{% url 'comment:reply' slug=object.slug pk=comment.pk %}" class="edit_and_delete">Reply</a></b>
        {% endif %}
      </div>

    {% else %}
      <div class="container-fluid commentContainer">
        <span class="comment_identifier">#{{ comment.identifier }} </span><b id="comment_author">{{ comment.author }}</b>
        <span id="comment_info"> {{ comment.created|timesince }} ago</span>
        <p>{{ comment.content }}</p>
        {% if comment.author == request.user %}
          <b><a href="{% url 'comment:update' pk=comment.pk %}" class="edit_and_delete">Edit</a></b>
          <b><a href="{% url 'comment:delete' pk=comment.pk %}" class="edit_and_delete">Delete</a></b>
        {% endif %}

        {% if user.is_authenticated and comment.author != request.user %}
          <b><a href="{% url 'comment:reply' slug=object.slug pk=comment.pk %}" class="edit_and_delete">Reply</a></b>
        {% endif %}
      </div>
    {% endif %}
  {% endfor %}
</div>
